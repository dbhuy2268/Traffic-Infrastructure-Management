@using Microsoft.AspNetCore.Identity

@inject SignInManager<TheFront.Areas.Identity.Data.ApplicationUser> SignInManager
@inject UserManager<TheFront.Areas.Identity.Data.ApplicationUser> UserManager

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - WebApp</title>

    <!--bootstrap-->
    <link rel="stylesheet" href="~/css/site.css" />
    <link href="~/css/style.css" rel="stylesheet" />

    <!--font awesome-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin="anonymous" />
    <script src="~/Scripts/Scripts.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.2/jquery.validate.min.js" integrity="sha512-UdIMMlVx0HEynClOIFSyOrPggomfhBKJE28LKl8yR3ghkgugPnG6iLfRfHwushZl1MOPSY6TsuBDGPK2X4zYKg==" crossorigin="anonymous"></script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>

    <!--====== Favicon Icon ======-->
    <link rel="shortcut icon" href="~/images/favicon.png" type="image/png">

    <!--====== Bootstrap css ======-->
    <link rel="stylesheet" href="~/css/landing/bootstrap.min.css">

    <!--====== Line Icons css ======-->
    <link rel="stylesheet" href="~/css/landing/LineIcons.css">

    <!--====== Magnific Popup css ======-->
    <link rel="stylesheet" href="~/css/landing/magnific-popup.css">

    <!--====== Slick css ======-->
    <link rel="stylesheet" href="~/css/landing/slick.css">

    <!--====== Animate css ======-->
    <link rel="stylesheet" href="~/css/landing/animate.css">

    <!--====== Default css ======-->
    <link rel="stylesheet" href="~/css/landing/default.css">

    <!--====== Style css ======-->
    <link rel="stylesheet" href="~/css/landing/style.css">

    <style>
        #inner-logo {
            display: none !important;
        }

        @@media (min-width: 768px) {
            #outer-logo {
                display: none !important;
            }

            #inner-logo {
                display: flex !important;
            }
        }
        /* Style The Dropdown Button */
        .dropbtn {
            border: none;
            cursor: pointer;
        }

        /* The container <div> - needed to position the dropdown content */
        .dropdown {
            position: relative;
            display: inline-block;
        }

        /* Dropdown Content (Hidden by Default) */
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
        }

            /* Links inside the dropdown */
            .dropdown-content a {
                color: black;
                padding: 12px 16px;
                text-decoration: none;
                display: block;
            }

        /* Show the dropdown menu on hover */
        .dropdown:hover .dropdown-content {
            display: block;
        }

        /* Change the background color of the dropdown button when the dropdown content is shown */
        .dropdown:hover .dropbtn {
            background-color: #3e8e41;
        }

        #logout-desktop {
            border: none;
            background-color: inherit;
        }
    </style>
</head>

<body style="overflow-y: scroll;">
    <header>
        @*============================ DUMMY NAV FOR FIXING BUG, CHANGES HERE WON'T APPLY ===================================*@
        <nav style="display:none;" class="navbar navbar-light navbar-expand-md bg-faded justify-content-center">
            <a class="navbar-brand d-flex w-25 mr-auto" href="/"><img style="height: 4em;" src="~/QLGT_BLUE.png" /></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsingNavbar3">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="navbar-collapse collapse w-100" id="collapsingNavbar3">
                <ul class="navbar-nav w-100 justify-content-center">
                    <li class="nav-item">
                        <a class="nav-link" href="#">Đăng ký</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/Home/Home_DangKiem">Đăng kiểm</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/Home/Create_BB">Xử lý vi phạm</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Cấp GPLX</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link disabled" href="#">Cảnh báo kẹt xe</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link disabled" href="#">Điều khiển giao thông</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link disabled" href="#">Tra cứu camera hành trình</a>
                    </li>
                </ul>
                <ul class="nav navbar-nav w-25 ml-auto justify-content-end">
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <i class="fa fa-bell"></i>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <i class="fa fa-cog"></i>
                        </a>
                    </li>
                </ul>
            </div>
        </nav>
        @*============================ END OF DUMMY NAV ===================================*@


        <nav class="navbar navbar-light navbar-expand-md bg-faded justify-content-center">
            <a id="outer-logo" href="/" class="navbar-brand d-flex mr-auto"><img style="height: 70px;" src="~/QLGT_BLUE.png" /></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsingNavbar3" style="@(ViewData["Title"].ToString() == "Index" ? "display: none;" : "")">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="navbar-collapse collapse w-100" id="collapsingNavbar3">
                <a id="inner-logo" href="/" class="navbar-brand d-flex w-25 mr-auto"><img style="height: 70px;" src="~/QLGT_BLUE.png" /></a>
                <div style="@(ViewData["Title"].ToString() == "Index" ? "display: none;" : "")">
                    <ul class="navbar-nav w-100 justify-content-center">
                        <li class="nav-item">
                            <a class="nav-link @(ViewData["Title"].ToString() == "Create_YeuCau" ? "active" : "")" asp-action="Create_YeuCau">Đăng ký</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link @(ViewData["Title"].ToString() == "Home_DangKiem" ? "active" : "")" asp-action="Home_DangKiem">Đăng kiểm</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link @(ViewData["Title"].ToString() == "Create_BB" ? "active" : "")" asp-action="Create_BB">Xử lý vi phạm</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link @(ViewData["Title"].ToString() == "Home_GPLX" ? "active" : "")" asp-action="Home_GPLX">Cấp GPLX</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Tra cứu luật</a>
                        </li>
                        @if (SignInManager.IsSignedIn(User))
                        {
                            <li class="nav-item more-menu">
                                <a id="manage" class="nav-link text-dark" asp-area="Identity" asp-page="/Account/Manage/Index" title="Manage">Cài đặt tài khoản</a>
                            </li>
                            <li class="nav-item more-menu">
                                <form id="logoutForm" class="form-inline" asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Action("Index", "Home", new { area = "" })">
                                    <button id="logout" type="submit" class="nav-link btn btn-link text-dark">Đăng xuất</button>
                                </form>
                            </li>
                        }
                        else
                        {
                            <li class="nav-item more-menu">
                                <a class="nav-link text-dark" id="register" asp-area="Identity" asp-page="/Account/Register">Đăng kí</a>
                            </li>
                            <li class="nav-item more-menu">
                                <a class="nav-link text-dark" id="login" asp-area="Identity" asp-page="/Account/Login">Đăng nhập</a>
                            </li>
                        }
                    </ul>
                </div>

                <ul id="@(ViewData["Title"].ToString() == "Index" ? "" : "more-menu")"
                    class="@(ViewData["Title"].ToString() == "Index" ? "" : "nav navbar-nav ml-auto w-25 justify-content-end")"
                    style="@(ViewData["Title"].ToString() == "Index" ? "position: absolute; right: 0; top: 30px; display: flex;" : "")">
                    @if (SignInManager.IsSignedIn(User))
                    {
                        <li class="nav-item" style="background-color: #f4f6f7; border-radius: 10px; margin-right: 5px">
                            <div class="dropdown">
                                <button id="manage" class="nav-link text-dark" style="background-color: inherit; border: none">@UserManager.GetUserName(User)!</button>
                                <div class="dropdown-content">
                                    <a style="margin-left: 8px" id="manage" class="nav-link text-dark" asp-area="Identity" asp-page="/Account/Manage/Index" title="Manage">Cài đặt tài khoản</a>
                                    <a id="logout-ref">
                                        <form id="logoutForm" class="form-inline" asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Action("Index", "Home", new { area = "" })">
                                            <button id="logout-desktop" type="submit">Đăng xuất</button>
                                        </form>
                                    </a>
                                </div>
                            </div>
                        </li>
                    }
                    else
                    {
                        <li class="nav-item">
                            <a class="nav-link text-dark" id="register" asp-area="Identity" asp-page="/Account/Register">Đăng kí</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-dark" id="login" asp-area="Identity" asp-page="/Account/Login">Đăng nhập</a>
                        </li>
                    }
                </ul>
            </div>
        </nav>

        <ul id="@(ViewData["Title"].ToString() == "Index" ? "" : "more-menu")"
            class="@(ViewData["Title"].ToString() == "Index" ? "" : "nav navbar-nav ml-auto w-25 justify-content-end")"
            style="@(ViewData["Title"].ToString() == "Index" ? "position: absolute; right: 0; top: 30px; display: flex;" : "display: none;")">
            @if (SignInManager.IsSignedIn(User))
            {
                <li class="nav-item" style="background-color: #f4f6f7; border-radius: 10px; margin-right: 5px">
                    <div class="dropdown">
                        <button id="manage" class="nav-link text-dark" style="background-color: inherit; border: none">@UserManager.GetUserName(User)!</button>
                        <div class="dropdown-content">
                            <a id="manage" class="nav-link text-dark" asp-area="Identity" asp-page="/Account/Manage/Index" title="Manage">Cài đặt tài khoản</a>
                            <a id="logout-ref">
                                <form id="logoutForm" class="form-inline" asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Action("Index", "Home", new { area = "" })">
                                    <button id="logout-desktop" type="submit">Đăng xuất</button>
                                </form>
                            </a>
                        </div>
                    </div>
                </li>
            }
            else
            {
                <li class="nav-item">
                    <a class="nav-link text-dark" id="register" asp-area="Identity" asp-page="/Account/Register">Đăng kí</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-dark" id="login" asp-area="Identity" asp-page="/Account/Login">Đăng nhập</a>
                </li>
            }
        </ul>
    </header>

    <div class="container" style="margin-bottom: 100px;">
        @RenderBody()
    </div>

    <footer class="border-top footer text-muted">
        <div class="container">
            &copy; 2020 - WebApp - <a asp-area="" asp-page="/Privacy">Chính sách bảo mật</a>
        </div>
    </footer>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>

    <script>
        initListener();
    </script>
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>